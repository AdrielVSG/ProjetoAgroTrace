# Documenta√ß√£o T√©cnica - AgroTrace

## üìã Resumo do Projeto

Este documento detalha a implementa√ß√£o completa do sistema AgroTrace, uma aplica√ß√£o web de rastreabilidade agr√≠cola sustent√°vel desenvolvida em React com Firebase.

## üèóÔ∏è Arquitetura do Sistema

### Frontend (React + Vite)
- **Framework**: React 18 com hooks funcionais
- **Build Tool**: Vite para desenvolvimento r√°pido
- **Roteamento**: React Router DOM v6
- **Estiliza√ß√£o**: Tailwind CSS com tema personalizado
- **Estado**: Context API para gerenciamento de estado global
- **√çcones**: Lucide React
- **Notifica√ß√µes**: React Hot Toast

### Backend (Firebase)
- **Autentica√ß√£o**: Firebase Auth
- **Banco de Dados**: Firestore (NoSQL)
- **Armazenamento**: Firebase Storage (para futuras implementa√ß√µes)

## üìÅ Estrutura Detalhada dos Arquivos

### Configura√ß√£o Base
```
‚îú‚îÄ‚îÄ package.json                 # Depend√™ncias e scripts
‚îú‚îÄ‚îÄ vite.config.js              # Configura√ß√£o do Vite
‚îú‚îÄ‚îÄ tailwind.config.js          # Configura√ß√£o do Tailwind
‚îú‚îÄ‚îÄ postcss.config.js           # Configura√ß√£o do PostCSS
‚îú‚îÄ‚îÄ index.html                  # HTML base
‚îî‚îÄ‚îÄ README.md                   # Documenta√ß√£o principal
```

### C√≥digo Fonte (src/)
```
src/
‚îú‚îÄ‚îÄ main.jsx                    # Ponto de entrada da aplica√ß√£o
‚îú‚îÄ‚îÄ App.jsx                     # Componente raiz com roteamento
‚îú‚îÄ‚îÄ index.css                   # Estilos globais e tema CSS
‚îú‚îÄ‚îÄ firebase/
‚îÇ   ‚îî‚îÄ‚îÄ config.js               # Configura√ß√£o do Firebase
‚îú‚îÄ‚îÄ contexts/
‚îÇ   ‚îî‚îÄ‚îÄ AuthContext.jsx         # Contexto de autentica√ß√£o
‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îî‚îÄ‚îÄ Layout.jsx              # Layout principal com sidebar
‚îî‚îÄ‚îÄ pages/                      # P√°ginas da aplica√ß√£o
    ‚îú‚îÄ‚îÄ LoginPage.jsx
    ‚îú‚îÄ‚îÄ DashboardPage.jsx
    ‚îú‚îÄ‚îÄ ScanPage.jsx
    ‚îú‚îÄ‚îÄ ProductDetailsPage.jsx
    ‚îú‚îÄ‚îÄ AddProductPage.jsx
    ‚îú‚îÄ‚îÄ StockPage.jsx
    ‚îú‚îÄ‚îÄ HistoryPage.jsx
    ‚îî‚îÄ‚îÄ ProfilePage.jsx
```

## üîß Configura√ß√£o Detalhada

### 1. Firebase Configuration (src/firebase/config.js)

```javascript
import { initializeApp } from 'firebase/app';
import { getAuth } from 'firebase/auth';
import { getFirestore } from 'firebase/firestore';
import { getStorage } from 'firebase/storage';

const firebaseConfig = {
  // Configura√ß√µes do seu projeto Firebase
};

const app = initializeApp(firebaseConfig);
export const auth = getAuth(app);
export const db = getFirestore(app);
export const storage = getStorage(app);
```

### 2. Tailwind Configuration (tailwind.config.js)

O Tailwind foi configurado para usar as vari√°veis CSS personalizadas do tema:

```javascript
export default {
  content: ["./index.html", "./src/**/*.{js,ts,jsx,tsx}"],
  theme: {
    extend: {
      colors: {
        // Mapeamento das vari√°veis CSS para classes Tailwind
        background: 'var(--color-background)',
        foreground: 'var(--color-foreground)',
        // ... outras cores
      }
    }
  }
}
```

### 3. Tema CSS (src/index.css)

O tema foi implementado usando CSS custom properties (vari√°veis CSS) que s√£o aplicadas atrav√©s do Tailwind:

```css
:root {
  --font-size: 16px;
  --background: #ffffff;
  --foreground: oklch(0.145 0 0);
  --primary: #030213;
  /* ... outras vari√°veis */
}

.dark {
  --background: oklch(0.145 0 0);
  --foreground: oklch(0.985 0 0);
  /* ... vari√°veis do tema escuro */
}
```

## üß© Componentes Principais

### 1. AuthContext (src/contexts/AuthContext.jsx)

**Responsabilidade**: Gerenciar estado de autentica√ß√£o global

**Funcionalidades**:
- Login/logout de usu√°rios
- Cadastro de novos usu√°rios
- Persist√™ncia de dados do usu√°rio
- Integra√ß√£o com Firestore para dados adicionais

**Hooks utilizados**:
- `useState` para estado local
- `useEffect` para observar mudan√ßas de autentica√ß√£o
- `onAuthStateChanged` do Firebase

### 2. Layout (src/components/Layout.jsx)

**Responsabilidade**: Layout principal com sidebar e navega√ß√£o

**Funcionalidades**:
- Sidebar responsiva (mobile/desktop)
- Navega√ß√£o entre p√°ginas
- Informa√ß√µes do usu√°rio logado
- Bot√£o de logout

**Props**: `children` (conte√∫do da p√°gina)

### 3. P√°ginas da Aplica√ß√£o

#### LoginPage (src/pages/LoginPage.jsx)
- **Funcionalidade**: Autentica√ß√£o e cadastro
- **Estados**: Login/Cadastro toggle
- **Valida√ß√£o**: Campos obrigat√≥rios
- **Integra√ß√£o**: Firebase Auth

#### DashboardPage (src/pages/DashboardPage.jsx)
- **Funcionalidade**: P√°gina inicial com estat√≠sticas
- **Diferencia√ß√£o**: Interface adaptada para consumidores/produtores
- **Componentes**: Cards de estat√≠sticas, a√ß√µes r√°pidas

#### ScanPage (src/pages/ScanPage.jsx)
- **Funcionalidade**: Simula√ß√£o de escaneamento de QR Code
- **Estados**: Escaneando, carregando, sucesso, erro
- **Integra√ß√£o**: Firestore para buscar produtos

#### ProductDetailsPage (src/pages/ProductDetailsPage.jsx)
- **Funcionalidade**: Exibir detalhes completos do produto
- **Recursos**: Avalia√ß√£o, compartilhamento, informa√ß√µes de sustentabilidade
- **Integra√ß√£o**: Firestore para salvar avalia√ß√µes

#### AddProductPage (src/pages/AddProductPage.jsx)
- **Funcionalidade**: Cadastro de produtos (apenas produtores)
- **Valida√ß√£o**: Campos obrigat√≥rios
- **Integra√ß√£o**: Firestore para salvar produtos

#### StockPage (src/pages/StockPage.jsx)
- **Funcionalidade**: Gest√£o de estoque (apenas produtores)
- **Recursos**: Listagem, filtros, remo√ß√£o de produtos
- **Integra√ß√£o**: Firestore em tempo real

#### HistoryPage (src/pages/HistoryPage.jsx)
- **Funcionalidade**: Hist√≥rico de produtos rastreados
- **Recursos**: Filtros, busca, estat√≠sticas
- **Integra√ß√£o**: Firestore para buscar avalia√ß√µes e produtos

#### ProfilePage (src/pages/ProfilePage.jsx)
- **Funcionalidade**: Gerenciamento de perfil
- **Recursos**: Edi√ß√£o de dados, prefer√™ncias, estat√≠sticas
- **Integra√ß√£o**: Firestore para atualizar dados

## üóÑÔ∏è Estrutura do Banco de Dados

### Firestore Collections

#### 1. Collection: `users`
```javascript
// Document ID: user.uid
{
  name: string,                    // Nome do usu√°rio
  email: string,                   // Email (√∫nico)
  type: 'consumer' | 'producer',   // Tipo de usu√°rio
  location: string,                // Localiza√ß√£o
  preferences: {                   // Prefer√™ncias do usu√°rio
    language: string,              // Idioma preferido
    notifications: boolean,        // Receber notifica√ß√µes
    darkMode: boolean             // Modo escuro
  },
  createdAt: string,              // Data de cria√ß√£o (ISO)
  updatedAt: string               // Data de atualiza√ß√£o (ISO)
}
```

#### 2. Collection: `products`
```javascript
// Document ID: QR Code ID
{
  name: string,                    // Nome do produto
  origin: string,                  // Origem/Fazenda
  waterUsage: string,              // Uso de √°gua
  certifications: string[],        // Array de certifica√ß√µes
  description: string,             // Descri√ß√£o detalhada
  environmentalImpact: string,     // Impacto ambiental
  harvestDate: string,             // Data da colheita
  batchNumber: string,             // N√∫mero do lote
  producerId: string,              // ID do produtor
  producerName: string,            // Nome do produtor
  createdAt: string,              // Data de cria√ß√£o
  updatedAt: string               // Data de atualiza√ß√£o
}
```

#### 3. Collection: `ratings`
```javascript
// Document ID: auto-generated
{
  product_id: string,              // ID do produto (QR Code)
  user_id: string,                 // ID do usu√°rio
  rating: number,                  // Avalia√ß√£o (1-5)
  timestamp: string                // Data da avalia√ß√£o
}
```

## üîê Regras de Seguran√ßa (Firestore)

```javascript
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {
    // Usu√°rios: apenas o pr√≥prio usu√°rio pode ler/escrever
    match /users/{userId} {
      allow read, write: if request.auth != null && request.auth.uid == userId;
    }
    
    // Produtos: leitura p√∫blica, escrita apenas pelo produtor
    match /products/{productId} {
      allow read: if true;
      allow write: if request.auth != null && 
        resource.data.producerId == request.auth.uid;
    }
    
    // Avalia√ß√µes: leitura p√∫blica, escrita por usu√°rios autenticados
    match /ratings/{ratingId} {
      allow read: if true;
      allow write: if request.auth != null && 
        request.auth.uid == resource.data.user_id;
    }
  }
}
```

## üé® Sistema de Design

### Cores Principais
- **Primary**: #030213 (Azul escuro)
- **Secondary**: oklch(0.95 0.0058 264.53) (Azul claro)
- **Success**: #4CAF50 (Verde)
- **Warning**: #FF9800 (Laranja)
- **Error**: #d4183d (Vermelho)

### Tipografia
- **Font Family**: Inter, system-ui, sans-serif
- **Font Sizes**: Sistema baseado em 16px (--font-size)
- **Font Weights**: 400 (normal), 500 (medium)

### Componentes Reutiliz√°veis
- **agro-card**: Card com sombra e bordas arredondadas
- **agro-button**: Bot√£o com estilos padronizados
- **agro-input**: Input com estilos consistentes

## üöÄ Deploy e Produ√ß√£o

### Build de Produ√ß√£o
```bash
npm run build
```

### Vari√°veis de Ambiente
Configure as seguintes vari√°veis no seu provedor de deploy:
- `VITE_FIREBASE_API_KEY`
- `VITE_FIREBASE_AUTH_DOMAIN`
- `VITE_FIREBASE_PROJECT_ID`
- `VITE_FIREBASE_STORAGE_BUCKET`
- `VITE_FIREBASE_MESSAGING_SENDER_ID`
- `VITE_FIREBASE_APP_ID`

### Otimiza√ß√µes de Produ√ß√£o
- Code splitting autom√°tico pelo Vite
- Minifica√ß√£o de CSS e JavaScript
- Tree shaking para remover c√≥digo n√£o utilizado
- Compress√£o de assets

## üß™ Testes e Qualidade

### Linting
```bash
npm run lint
```

### Estrutura de Testes (Futuro)
```
src/
‚îú‚îÄ‚îÄ __tests__/
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îî‚îÄ‚îÄ utils/
‚îú‚îÄ‚îÄ __mocks__/
‚îî‚îÄ‚îÄ setupTests.js
```

## üì± Responsividade

### Breakpoints
- **Mobile**: < 768px
- **Tablet**: 768px - 1024px
- **Desktop**: > 1024px

### Estrat√©gia Mobile-First
- Design baseado em mobile
- Progressive enhancement para telas maiores
- Sidebar colaps√°vel em mobile

## üîÑ Estado da Aplica√ß√£o

### Contextos Globais
1. **AuthContext**: Estado de autentica√ß√£o
   - `user`: Dados do usu√°rio logado
   - `loading`: Estado de carregamento
   - `login()`: Fun√ß√£o de login
   - `logout()`: Fun√ß√£o de logout
   - `signup()`: Fun√ß√£o de cadastro

### Estado Local
- Cada p√°gina gerencia seu pr√≥prio estado local
- Hooks `useState` e `useEffect` para gerenciamento
- Integra√ß√£o com Firestore para persist√™ncia

## üöß Limita√ß√µes e Melhorias Futuras

### Limita√ß√µes Atuais
1. Scanner de QR Code simulado (n√£o real)
2. Sem notifica√ß√µes push
3. Sem upload de imagens
4. Sem relat√≥rios avan√ßados
5. Sem testes automatizados

### Melhorias Planejadas
1. **Scanner Real**: Integra√ß√£o com biblioteca de QR Code
2. **PWA**: Transformar em Progressive Web App
3. **Notifica√ß√µes**: Firebase Cloud Messaging
4. **Imagens**: Upload e exibi√ß√£o de fotos dos produtos
5. **Relat√≥rios**: Gr√°ficos e an√°lises avan√ßadas
6. **Testes**: Cobertura completa de testes
7. **Performance**: Otimiza√ß√µes e lazy loading

## üìä M√©tricas e Monitoramento

### Firebase Analytics (Futuro)
- Eventos de usu√°rio
- Convers√µes
- Reten√ß√£o
- Performance

### Logs de Erro
- Console.error para erros JavaScript
- Toast notifications para feedback
- Firebase Crashlytics (futuro)

## üîí Seguran√ßa

### Autentica√ß√£o
- Firebase Auth com email/senha
- Valida√ß√£o de campos obrigat√≥rios
- Sanitiza√ß√£o de inputs

### Autoriza√ß√£o
- Regras do Firestore baseadas em usu√°rio
- Verifica√ß√£o de tipo de usu√°rio (produtor/consumidor)
- Valida√ß√£o de permiss√µes em cada a√ß√£o

### Dados Sens√≠veis
- N√£o armazenamento de senhas (Firebase Auth)
- Valida√ß√£o de dados no frontend e backend
- Sanitiza√ß√£o de outputs

## üìà Performance

### Otimiza√ß√µes Implementadas
- Lazy loading de componentes
- Code splitting por rota
- Otimiza√ß√£o de imagens
- Minifica√ß√£o de CSS/JS

### M√©tricas de Performance
- First Contentful Paint (FCP)
- Largest Contentful Paint (LCP)
- Cumulative Layout Shift (CLS)
- Time to Interactive (TTI)

## üéØ Conclus√£o

O AgroTrace foi desenvolvido seguindo as melhores pr√°ticas de desenvolvimento React, com foco em:

1. **Usabilidade**: Interface intuitiva e responsiva
2. **Performance**: Carregamento r√°pido e otimizado
3. **Escalabilidade**: Arquitetura preparada para crescimento
4. **Manutenibilidade**: C√≥digo limpo e bem documentado
5. **Seguran√ßa**: Autentica√ß√£o e autoriza√ß√£o robustas

O sistema est√° pronto para uso em produ√ß√£o e pode ser facilmente expandido com novas funcionalidades conforme necess√°rio.
